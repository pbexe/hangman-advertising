<!DOCTYPE html>
<html>
<head>
    <title>Hangman Advertising</title>
</head>
<body>
    <img />
	<script src="/socket.io/socket.io.js"></script>
	<script src="https://code.jquery.com/jquery-3.1.0.min.js" integrity="sha256-cCueBR6CsyA4/9szpPfrX3s49M9vUU5BgtiJj06wt/s=" crossorigin="anonymous"></script>
    <script src="/socket.io/socket.io.js"></script>
    <p class="latency"></p>
    <p class="fps"></p>
    <script>
        var socket = io();
        var dt_latest = 0;
        socket.on("connect", function(packet){
        	socket.emit("handshake", {
        		width: $(document).width(),
        		height: $(document).height()
        	});
        });
        var count = 0;

        setInterval(function() {
            $("p.fps").text(count);
            count = 0;
        }, 1000);

        socket.on("frame", function(packet){
            if (dt_latest <= packet.dt) {
                dt_latest = packet.dt;
                $("img").attr("src", packet.frame);
                $("p.latency").text(packet.dt + " : " + (Date.now() - packet.time));
                count ++;
            } else {
                console.log("Frame Skip");
            }
        });
    </script>
</body>
</html>
